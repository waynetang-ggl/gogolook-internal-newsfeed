<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gogolook Internal AI Newsletter</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header Section - 模仿原本電子報的藍色標題區塊 */
        .header {
            background: linear-gradient(135deg, #4a90e2, #357abd);
            color: white;
            text-align: center;
            padding: 40px 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(74, 144, 226, 0.3);
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 300;
            margin-bottom: 10px;
            letter-spacing: 2px;
        }

        .header .subtitle {
            font-size: 0.9rem;
            opacity: 0.8;
            font-weight: 300;
        }

        /* Form Section */
        .form-section {
            background: white;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
            font-size: 0.95rem;
        }

        .form-group input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus {
            outline: none;
            border-color: #4a90e2;
            box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.1);
        }

        .form-group input.error {
            border-color: #e74c3c;
        }

        .error-message {
            color: #e74c3c;
            font-size: 0.85rem;
            margin-top: 5px;
            display: none;
        }

        /* Tags Input */
        .tags-container {
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            padding: 8px;
            min-height: 50px;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            align-items: flex-start;
            transition: border-color 0.3s ease;
        }

        .tags-container:focus-within {
            border-color: #4a90e2;
            box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.1);
        }

        .tag {
            background-color: #4a90e2;
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .tag .remove-tag {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 1.1rem;
            padding: 0;
            width: 16px;
            height: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background-color 0.2s ease;
        }

        .tag .remove-tag:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }

        .tags-input {
            border: none;
            outline: none;
            flex: 1;
            min-width: 120px;
            padding: 8px 4px;
            font-size: 1rem;
        }

        /* RSS Section */
        .rss-section {
            position: relative;
        }

        .rss-label {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .rss-help {
            position: relative;
            display: inline-block;
            cursor: help;
        }

        .rss-help .help-icon {
            width: 18px;
            height: 18px;
            background-color: #4a90e2;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .rss-help .tooltip {
            position: absolute;
            bottom: 25px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #333;
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.8rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
            z-index: 1000;
        }

        .rss-help .tooltip::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 5px solid transparent;
            border-top-color: #333;
        }

        .rss-help:hover .tooltip {
            opacity: 1;
            visibility: visible;
        }

        .rss-urls {
            margin-top: 10px;
        }

        .rss-url-item {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            align-items: center;
        }

        .rss-url-item input {
            flex: 1;
        }

        .remove-rss {
            background-color: #e74c3c;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: background-color 0.3s ease;
        }

        .remove-rss:hover {
            background-color: #c0392b;
        }

        .add-rss {
            background-color: #27ae60;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
            margin-top: 10px;
            transition: background-color 0.3s ease;
        }

        .add-rss:hover {
            background-color: #229954;
        }

        /* Submit Button */
        .submit-btn {
            background: linear-gradient(135deg, #4a90e2, #357abd);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 6px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            transition: transform 0.2s ease, box-shadow 0.3s ease;
            margin-top: 20px;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(74, 144, 226, 0.3);
        }

        .submit-btn:active {
            transform: translateY(0);
        }

        .submit-btn:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* Success Message */
        .success-message {
            background-color: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 6px;
            margin-top: 20px;
            display: none;
            text-align: center;
        }

        /* Description Section */
        .description-section {
            background: white;
            padding: 30px 40px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }

        .description-section h2 {
            color: #4a90e2;
            font-size: 1.8rem;
            margin-bottom: 20px;
            font-weight: 600;
        }

        .description-section p {
            margin-bottom: 15px;
            line-height: 1.7;
            color: #555;
        }

        /* Info Section */
        .info-section {
            margin-bottom: 30px;
        }

        .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .info-card {
            background: white;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .info-card h3 {
            color: #4a90e2;
            font-size: 1.3rem;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .keywords-display {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            max-height: 200px;
            overflow-y: auto;
        }

        .keyword-tag {
            background-color: #e3f2fd;
            color: #1976d2;
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            border: 1px solid #bbdefb;
        }

        .sources-display {
            max-height: 200px;
            overflow-y: auto;
        }

        .source-item {
            padding: 8px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .source-item:last-child {
            border-bottom: none;
        }

        .source-name {
            font-weight: 600;
            color: #333;
            margin-bottom: 2px;
        }

        .source-description {
            font-size: 0.85rem;
            color: #666;
        }

        /* Action Buttons Section */
        .action-buttons-section {
            text-align: center;
            margin-bottom: 40px;
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .slack-button, .preview-button {
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            transition: transform 0.2s ease, box-shadow 0.3s ease;
            border: none;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
        }

        .slack-button {
            background: linear-gradient(135deg, #4a154b, #611f69);
            color: white;
            box-shadow: 0 4px 15px rgba(74, 21, 75, 0.3);
        }

        .slack-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(74, 21, 75, 0.4);
            text-decoration: none;
            color: white;
        }

        .preview-button {
            background: linear-gradient(135deg, #4a90e2, #357abd);
            color: white;
            box-shadow: 0 4px 15px rgba(74, 144, 226, 0.3);
        }

        .preview-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(74, 144, 226, 0.4);
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background-color: white;
            margin: 2% auto;
            padding: 0;
            border-radius: 12px;
            width: 90%;
            max-width: 900px;
            max-height: 90vh;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .modal-header {
            background: linear-gradient(135deg, #4a90e2, #357abd);
            color: white;
            padding: 20px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h2 {
            margin: 0;
            font-size: 1.5rem;
        }

        .close-button {
            font-size: 2rem;
            font-weight: bold;
            cursor: pointer;
            padding: 0 10px;
            border-radius: 50%;
            transition: background-color 0.3s ease;
        }

        .close-button:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }

        .modal-body {
            padding: 30px;
            max-height: 70vh;
            overflow-y: auto;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            .header h1 {
                font-size: 2rem;
            }

            .form-section, .description-section, .info-card {
                padding: 25px 20px;
            }

            .info-grid {
                grid-template-columns: 1fr;
            }

            .rss-url-item {
                flex-direction: column;
                align-items: stretch;
            }

            .remove-rss {
                align-self: flex-end;
                width: fit-content;
            }

            .action-buttons-section {
                flex-direction: column;
                gap: 15px;
            }

            .slack-button, .preview-button {
                width: 100%;
                text-align: center;
            }

            .modal-content {
                width: 95%;
                margin: 5% auto;
            }

            .modal-header {
                padding: 15px 20px;
            }

            .modal-body {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header Section -->
        <div class="header">
            <h1>Gogolook Internal AI Newsletter</h1>
            <div class="subtitle">prototype powered by DayONE</div>
        </div>

        <!-- Form Section -->
        <div class="form-section">
            <form id="newsletterForm">
                <!-- Email Input -->
                <div class="form-group">
                    <label for="email">電子郵件地址 *</label>
                    <input type="email" id="email" name="email" required>
                    <div class="error-message" id="emailError">請輸入有效的 @gogolook.com 電子郵件地址</div>
                </div>

                <!-- Keywords Input -->
                <div class="form-group">
                    <label for="keywords">關鍵字許願池</label>
                    <div class="tags-container" id="tagsContainer">
                        <input type="text" class="tags-input" id="tagsInput" placeholder="輸入關鍵字後按 Enter 新增...">
                    </div>
                </div>

                <!-- RSS URLs Input -->
                <div class="form-group rss-section">
                    <div class="rss-label">
                        <label>Resource 推薦</label>
                        <div class="rss-help">
                            <div class="help-icon">?</div>
                            <div class="tooltip">RSS 是一種網頁內容格式，讓您可以訂閱網站的最新文章和更新</div>
                        </div>
                    </div>
                    <div class="rss-urls" id="rssUrls">
                        <div class="rss-url-item">
                            <input type="url" placeholder="輸入 RSS feed URL..." class="rss-input">
                            <button type="button" class="remove-rss" onclick="removeRssUrl(this)">移除</button>
                        </div>
                    </div>
                    <button type="button" class="add-rss" onclick="addRssUrl()">+ 新增 RSS URL</button>
                </div>

                <!-- Submit Button -->
                <button type="submit" class="submit-btn">Subscribe</button>
            </form>

            <!-- Success Message -->
            <div class="success-message" id="successMessage">
                🎉 訂閱成功！感謝您的註冊，我們會盡快為您準備精彩的 AI 新聞內容。
            </div>
        </div>

        <!-- Project Description Section -->
        <div class="description-section">
            <h2>README</h2>
            <p>Gogolook Internal Newsfeed 的概念起源於 DayONE 團隊的內部需求。</p>
            <p>幾個月前，團隊密切的協助公司進行和 World ID 的合作研究，為了保持對潛在合作夥伴的持續了解，團隊用 Make 自動化流程每天撈取 World ID, Worldcoin, World App 等關鍵字的相關新聞，來跟上 web3 公司的最新消息。</p>
            <p>後來團隊觀察發現，各團隊每個階段都會有較密切關注的議題需要追蹤，但繁忙之餘未必能保持資訊更新，於是團隊就實踐了 "pretotype" 的精神，簡單用 vibe coding + LLM 做了一個內部的 AI Newsletter，嘗試解決並驗證公司同仁是否也同樣具有需求，歡迎大家訂閱並給予任何 Feedback!</p>
            <p>當然，也歡迎大家 commit / 一起迭代這個服務 😉</p>
        </div>

        <!-- Current Version Info Section -->
        <div class="info-section">
            <div class="info-grid">
                <div class="info-card">
                    <h3>目前版本關鍵字</h3>
                    <div class="keywords-display" id="keywordsDisplay">
                        <!-- Keywords will be loaded here -->
                    </div>
                </div>
                <div class="info-card">
                    <h3>目前版本資訊來源</h3>
                    <div class="sources-display" id="sourcesDisplay">
                        <!-- RSS sources will be loaded here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Action Buttons Section -->
        <div class="action-buttons-section">
            <a href="#" class="slack-button" id="slackButton">
                📰 AI NewsFeed in Slack
            </a>
            <button class="preview-button" id="previewButton">
                📧 每日新聞預覽
            </button>
        </div>

        <!-- News Preview Modal -->
        <div class="modal" id="newsModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>📧 每日新聞預覽 - 2025/08/06</h2>
                    <span class="close-button" id="closeModal">&times;</span>
                </div>
                <div class="modal-body" id="modalBody">
                    <!-- 新聞內容將在這裡動態載入 -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Keywords and RSS sources data
        const keywordsData = {
            "keywords": [
                "Gogolook", "Whoscall", "JUJI", "Roo", "袋鼠金融", "World ID", "反詐戰警", "TrueCaller",
                "數發部打詐", "打詐儀表板", "打詐", "詐騙", "詐騙防治", "詐騙防治中心", "反詐", "詐欺",
                "詐騙集團", "假投資", "假貸款", "釣魚網站", "釣魚郵件", "網路詐騙", "電信詐騙", "投資詐騙",
                "愛情詐騙", "假冒", "冒充", "假客服", "假銀行", "假警察", "假檢察官", "一頁式", "一頁式詐騙",
                "假網站", "假APP", "假平台", "抽獎詐騙", "解除分期", "ATM詐騙", "網購詐騙", "購物詐騙",
                "假賣家", "假買家", "線上購物詐騙", "虛擬貨幣詐騙", "加密貨幣詐騙", "數位貨幣詐騙",
                "NFT詐騙", "區塊鏈詐騙", "交友詐騙", "婚姻詐騙", "感情詐騙", "援助詐騙", "慈善詐騙",
                "假慈善", "假捐款", "詐騙手法", "詐騙案例", "詐騙防範", "詐騙警示", "詐騙提醒", "反詐騙",
                "防詐騙", "防詐", "165反詐騙", "警政署165", "警察局詐騙", "詐騙機房", "詐騙車手",
                "詐騙人頭", "詐騙帳戶", "警示帳戶", "凍結帳戶", "洗錢", "人頭帳戶", "帳戶盜用",
                "身分盜用", "個資外洩", "個資詐騙", "資料外洩", "社交工程", "網路釣魚", "簡訊詐騙",
                "LINE詐騙", "臉書詐騙", "IG詐騙", "社群詐騙", "通訊軟體詐騙", "黃牛", "黃牛詐騙",
                "investment scam", "romance scam", "lottery scam", "fake charity", "fake investment",
                "fake loan", "fake website", "fake app", "scammer", "fraudster", "online fraud"
            ]
        };

        const rssSourcesData = {
            "sources": [
                {"url": "https://technews.tw/feed/", "name": "科技新報", "description": "科技相關新聞"},
                {"url": "https://news.ltn.com.tw/rss/society.xml", "name": "自由時報 社會", "description": "自由時報社會新聞"},
                {"url": "https://news.ltn.com.tw/rss/life.xml", "name": "自由時報 生活", "description": "自由時報生活新聞"},
                {"url": "https://news.ltn.com.tw/rss/business.xml", "name": "自由時報 財經", "description": "自由時報財經新聞"},
                {"url": "https://feeds.feedburner.com/rsscna/technology", "name": "中央社 科技", "description": "中央社科技新聞"},
                {"url": "https://feeds.feedburner.com/rsscna/finance", "name": "中央社 財經", "description": "中央社財經新聞"},
                {"url": "https://feeds.bbci.co.uk/news/world/rss.xml", "name": "BBC 世界新聞", "description": "BBC 世界新聞 (英文)"},
                {"url": "https://rss.nytimes.com/services/xml/rss/nyt/HomePage.xml", "name": "紐約時報", "description": "紐約時報 (英文)"},
                {"url": "https://news.google.com/rss?hl=zh-TW&gl=TW&ceid=TW:zh-Hant", "name": "Google 新聞", "description": "Google 台灣新聞"},
                {"url": "https://news.google.com/rss/topics/CAAqLAgKIiZDQkFTRmdvSkwyMHZNR1ptZHpWbUVnVjZhQzFVVnhvQ1ZGY29BQVAB?hl=zh-TW&gl=TW&ceid=TW%3Azh-Hant", "name": "Google 科技", "description": "Google 科技新聞"},
                {"url": "https://www3.nhk.or.jp/rss/news/cat0.xml", "name": "NHK 日本新聞", "description": "NHK 日本新聞 (日文)"},
                {"url": "https://www3.nhk.or.jp/rss/news/cat3.xml", "name": "NHK 日本科學醫療", "description": "NHK 日本科學醫療 (日文)"},
                {"url": "https://www.asahi.com/rss/asahi/science.rdf", "name": "朝日新聞 科學與科技", "description": "朝日新聞科學與科技新聞 (日文)"},
                {"url": "https://www.theguardian.com/world/rss", "name": "衛報 世界新聞", "description": "衛報世界新聞 (英文)"}
            ]
        };

        // Sample news data (from the EML file)
        const sampleNewsData = [
            {
                title: "方仰寧接任新北警局長 侯友宜盼加強打詐力道",
                source: "自由時報 社會",
                date: "2025/08/06 上午03:14",
                summary: "新北市警察局長由前警察專科學校長方仰寧接任，市長侯友宜期待侯友宜相信在方仰寧的領導下，新北市的治安、交通和民眾服務將更臻完善，方仰寧曾出任市府顧問，展望未來將致力於提升警政工作表現。"
            },
            {
                title: "內湖母女遭詐輕生亡 家屬控警言語輕佻害命、檢不起訴原因曝",
                source: "自由時報 社會", 
                date: "2025/08/06 上午02:18",
                summary: "內湖母女因遭詐騙投資1200萬元，專責情緒崩潰走上絕路，家屬指控警方言語輕佻害命，提告警察不當言論。家屬懷疑警察的慰勞對自殺者，並認為警察未能提供實質的原因。此案件引發社會關注，凸顯詐騙事件對受害者及其家屬的嚴重影響。"
            },
            {
                title: "可怕！臉書一頁式廣告詐騙 監所內嫌犯鋼筋水泥都能賣",
                source: "自由時報 社會",
                date: "2025/08/06 上午01:11", 
                summary: "詐騙集團利用臉書一頁式廣告詐騙旅客，在臉書上以一頁式廣告吸引民眾，宣稱從獄中所獲得的鋼筋水泥。這些原始原料的高額詐騙案例受到警察關注，但遭到不被信任的刑用。詐騙集團的行為可能影響到都市建設的聲譽，也讓民眾陷入風險之中。"
            },
            {
                title: "小心有詐！偽冒台東觀光局騙 詐騙經緯線流",
                source: "自由時報 生活",
                date: "2025/08/06 上午04:16",
                summary: "近期經緯線上出現偽冒「台東觀光局推廣」或「旅遊推廣」的詐騙廣告和不實經緯線，台東縣政府已指出正確名稱「台東一般未知」的觀光推廣活動。民眾注意避免詐騙，只透過官方管道取得旅遊資訊，以免遭受詐騙損失。"
            },
            {
                title: "打擊桃機工程 包商涉洗錢逾3200萬元遭起訴",
                source: "中央社 社會",
                date: "2025/08/06 上午03:33",
                summary: "桃機建設公司！東港涉及洗錢罪嫌犯被起訴涉及打擊桃機工程，其中一名東港公司負責人涉嫌公司負責人涉嫌，透過假交易手法詐騙取得逾3200萬元。北檢已於6日對涉案人員提起訴訟，指控涉及詐騙和洗錢等罪名。"
            }
        ];

        // Load keywords and sources on page load
        document.addEventListener('DOMContentLoaded', function() {
            loadKeywords();
            loadSources();
            initializeModal();
        });

        function loadKeywords() {
            const keywordsDisplay = document.getElementById('keywordsDisplay');
            const displayKeywords = keywordsData.keywords.slice(0, 50); // Show first 50 keywords
            
            keywordsDisplay.innerHTML = displayKeywords.map(keyword => 
                `<span class="keyword-tag">${keyword}</span>`
            ).join('');

            if (keywordsData.keywords.length > 50) {
                const moreTag = document.createElement('span');
                moreTag.className = 'keyword-tag';
                moreTag.textContent = `+${keywordsData.keywords.length - 50} more...`;
                moreTag.style.backgroundColor = '#f0f0f0';
                moreTag.style.color = '#666';
                keywordsDisplay.appendChild(moreTag);
            }
        }

        function loadSources() {
            const sourcesDisplay = document.getElementById('sourcesDisplay');
            const displaySources = rssSourcesData.sources.slice(0, 15); // Show first 15 sources
            
            sourcesDisplay.innerHTML = displaySources.map(source => 
                `<div class="source-item">
                    <div class="source-name">${source.name}</div>
                    <div class="source-description">${source.description}</div>
                </div>`
            ).join('');

            if (rssSourcesData.sources.length > 15) {
                const moreItem = document.createElement('div');
                moreItem.className = 'source-item';
                moreItem.innerHTML = `
                    <div class="source-name" style="color: #666;">+${rssSourcesData.sources.length - 15} more sources...</div>
                    <div class="source-description">包含更多國內外新聞來源</div>
                `;
                sourcesDisplay.appendChild(moreItem);
            }
        }

        // Modal functionality
        function initializeModal() {
            const previewButton = document.getElementById('previewButton');
            const modal = document.getElementById('newsModal');
            const closeButton = document.getElementById('closeModal');
            const modalBody = document.getElementById('modalBody');

            // Open modal
            previewButton.addEventListener('click', function() {
                loadNewsPreview();
                modal.style.display = 'block';
                document.body.style.overflow = 'hidden'; // Prevent background scrolling
            });

            // Close modal
            closeButton.addEventListener('click', function() {
                modal.style.display = 'none';
                document.body.style.overflow = 'auto';
            });

            // Close modal when clicking outside
            window.addEventListener('click', function(event) {
                if (event.target === modal) {
                    modal.style.display = 'none';
                    document.body.style.overflow = 'auto';
                }
            });

            // Close modal with ESC key
            document.addEventListener('keydown', function(event) {
                if (event.key === 'Escape' && modal.style.display === 'block') {
                    modal.style.display = 'none';
                    document.body.style.overflow = 'auto';
                }
            });
        }

        function loadNewsPreview() {
            const modalBody = document.getElementById('modalBody');
            
            let newsHTML = `
                <div style="background: linear-gradient(135deg, #e7f1fd 0%, #ffffff 100%); padding: 20px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #4a90e2;">
                    <strong>今日摘要：</strong>共找到 13 篇相關新聞。
                </div>
            `;

            sampleNewsData.forEach((news, index) => {
                newsHTML += `
                    <div style="background: white; border: 1px solid #e7f1fd; border-radius: 8px; margin-bottom: 20px; padding: 20px; transition: box-shadow 0.3s ease;">
                        <div style="font-size: 18px; font-weight: bold; color: #0f2647; margin-bottom: 10px; line-height: 1.4;">
                            ${index + 1}. ${news.title}
                        </div>
                        
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding: 10px 15px; background-color: #e7f1fd; border-radius: 4px; font-size: 12px; color: #0f2647; gap: 10px;">
                            <div>
                                <span style="font-weight: bold; color: #0058ea; margin-right: 10px;">來源：${news.source}</span>
                            </div>
                            <div>
                                <span style="color: #666; font-size: 12px;">時間：${news.date}</span>
                            </div>
                        </div>
                        
                        <div style="color: #0f2647; margin-bottom: 15px; line-height: 1.6;">
                            ${news.summary}
                        </div>
                        
                        <a href="#" style="display: inline-block; background-color: #0058ea; color: white !important; padding: 8px 16px; text-decoration: none; border-radius: 4px; font-size: 14px; transition: background-color 0.3s ease;">
                            閱讀原文
                        </a>
                    </div>
                `;
            });

            newsHTML += `
                <div style="background-color: #e7f1fd; padding: 20px; text-align: center; border-top: 1px solid #008cf4; font-size: 12px; color: #0f2647; margin-top: 20px;">
                    <p style="margin-top: 10px;">© 2025 Dayone</p>
                </div>
            `;

            modalBody.innerHTML = newsHTML;
        }

        // Tags functionality
        const tagsContainer = document.getElementById('tagsContainer');
        const tagsInput = document.getElementById('tagsInput');
        const tags = new Set();

        tagsInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                e.preventDefault();
                const tag = this.value.trim();
                if (tag && !tags.has(tag)) {
                    addTag(tag);
                    this.value = '';
                }
            }
        });

        function addTag(tagText) {
            tags.add(tagText);
            const tagElement = document.createElement('div');
            tagElement.className = 'tag';
            tagElement.innerHTML = `
                ${tagText}
                <button type="button" class="remove-tag" onclick="removeTag('${tagText}', this.parentElement)">×</button>
            `;
            tagsContainer.insertBefore(tagElement, tagsInput);
        }

        function removeTag(tagText, tagElement) {
            tags.delete(tagText);
            tagElement.remove();
        }

        // RSS URLs functionality
        function addRssUrl() {
            const rssUrls = document.getElementById('rssUrls');
            const newRssItem = document.createElement('div');
            newRssItem.className = 'rss-url-item';
            newRssItem.innerHTML = `
                <input type="url" placeholder="輸入 RSS feed URL..." class="rss-input">
                <button type="button" class="remove-rss" onclick="removeRssUrl(this)">移除</button>
            `;
            rssUrls.appendChild(newRssItem);
        }

        function removeRssUrl(button) {
            const rssUrls = document.getElementById('rssUrls');
            if (rssUrls.children.length > 1) {
                button.parentElement.remove();
            }
        }

        // Email validation
        function validateEmail(email) {
            return email.endsWith('@gogolook.com') && email.includes('@');
        }

        // Form submission
        document.getElementById('newsletterForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const email = document.getElementById('email').value;
            const emailError = document.getElementById('emailError');
            const submitBtn = document.querySelector('.submit-btn');
            const successMessage = document.getElementById('successMessage');

            // Reset error states
            document.getElementById('email').classList.remove('error');
            emailError.style.display = 'none';

            // Validate email
            if (!validateEmail(email)) {
                document.getElementById('email').classList.add('error');
                emailError.style.display = 'block';
                return;
            }

            // Collect data
            const keywords = Array.from(tags).join(', ');
            const rssInputs = document.querySelectorAll('.rss-input');
            const rssUrls = Array.from(rssInputs)
                .map(input => input.value.trim())
                .filter(url => url !== '')
                .join(', ');

            const formData = {
                subscriberEmail: email,
                keywordSuggestion: keywords,
                resourceSuggestion: rssUrls
            };

            // Disable submit button
            submitBtn.disabled = true;
            submitBtn.textContent = '提交中...';

            try {
                // TODO: Replace with your actual Make webhook URL
                const webhookUrl = 'YOUR_MAKE_WEBHOOK_URL_HERE';
                
                const response = await fetch(webhookUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData)
                });

                if (response.ok) {
                    // Show success message
                    successMessage.style.display = 'block';
                    this.style.display = 'none';
                } else {
                    throw new Error('提交失敗');
                }
            } catch (error) {
                alert('提交時發生錯誤，請稍後再試。');
                console.error('Error:', error);
            } finally {
                // Re-enable submit button
                submitBtn.disabled = false;
                submitBtn.textContent = 'Subscribe';
            }
        });
    </script>
</body>
</html>